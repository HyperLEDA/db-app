Для корректной работы локальной версии приложения нужны следующие пакеты:

- `git`
- `make`
- `uv` - менеджер пакетов для Python. Устанавливается [вот тут](https://docs.astral.sh/uv/getting-started/installation/#standalone-installer).
- пакет `libpq` (`apt-get install libpq-dev` на Ubuntu, `brew install libpq` на MacOS). Обычно поставляется вместе с Postgres.
- `docker`: <https://docs.docker.com/engine/install/>
- `docker-compose` (скорее всего будет установлен вместе с `docker`): <https://docs.docker.com/compose/install/linux/>

### Установка базовой версии

1. Склонировать к себе репозиторий:
    ```bash
    git clone https://github.com/HyperLEDA/db-app.git
    cd db-app
    ```

2. В директории проекта установить все зависимости:
    ```
    make install
    ```

### Установка версии для разработки

1. Проделать шаги для установки [базовой версии](#_1)

2. Установить все зависимости, включая зависимости для тестирования.
    ```bash
    make install-dev
    ```

3. Чтобы проверить, что зависимости установились корректно, можно прогнать полный набор тестов:
    ```bash
    make test-all
    ```

    Этот же набор тестов можно запускать при любых изменениях в коде, он же запускается при создании Pull Request в GitHub.

4. Подключиться к локальной версии базы данных можно при помощи команды

    ```
    make start-db
    ```

    Эта команда поднимет контейнер (об этом стоит почитать подробнее, но, простыми словами, контейнер - это изолированная от всей остальной системы виртуальная машина, доступная из терминала) с БД Postgres нужной нам версии, прогонит там все файлы ("миграции") из <https://github.com/HyperLEDA/db-app/tree/master/postgres/migrations> в нужном порядке (от версии `V001` до последней) и таким образом восстановит самую актуальную схему базы данных.

    Далее подключиться к этой базе данных можно будет по строке подключения `postgresql://127.0.0.1:6432/hyperleda?user=hyperleda&password=password` через любой клиент Postgres, например, `psql` (поставляется вместе с Postgres на всех системах):

    ```
    psql -d 'postgresql://127.0.0.1:6432/hyperleda?user=hyperleda&password=password'
    ```

    Внутри можно запускать любые SQL команды для тестирования, все изменения будут только на вашем компьютере. При изменениях файлов миграций нужно перезапустить контейнер с базой данных (но стоит иметь ввиду, что это сотрёт все данные в ней):

    ```
    make stop-db
    make start-db
    ```
